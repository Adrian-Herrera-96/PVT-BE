<?php
use Muserpol\Models\Affiliate;

DB::table('observables')->where('observation_type_id', 2)->whereNull('deleted_at')->where('observable_type', 'affiliates')->update(['deleted_at' => \Carbon\Carbon::now()]);

$collect = collect([
    '1006921',
    '1422662',
    '2222403',
    '2293384',
    '2303106',
    '2737258',
    '3082005',
    '3100337',
    '4059226',
    '5123819',
    '5756175',
    '6198637',
    '6899584',
    '7581050',
    '8264429',
    '8578974',
    '1501515',
    '939467',
    '969242',
    '1333574',
    '2409322',
    '2598285',
    '2740578',
    '481531',
    '633068',
    '928749',
    '983972',
    '1053020',
    '1057254',
    '1205895',
    '1263752',
    '1277642',
    '1280659',
    '1319711',
    '1331207',
    '1392408',
    '1553674',
    '1718512',
    '1791318-1J',
    '2014639',
    '2057113',
    '2066499',
    '2183222',
    '2221545',
    '2234497',
    '2255681',
    '2288824',
    '2302172',
    '2302247',
    '2322868',
    '2347832',
    '2378433',
    '2386682',
    '2405497',
    '2407452',
    '2428903',
    '2458219',
    '2478726',
    '2522752',
    '2559989',
    '2568785',
    '2725370',
    '2832665',
    '2926848',
    '3319665',
    '2266153-1U',
    '2520764-1O',
    '922962',
    '2283628',
    '2534406',
    '2937665',
    '3374113',
    '4747970',
    '5960677',
    '1732975',
    '6545204',
    '1258350-1J',
    '666049',
    '1794003',
    '1798509',
    '2077209',
    '2522466',
    '5984978',
    '490530',
    '2014639',
    '543355',
    '3485905',
    '2964606',
    '3484945',
    '7593738',
    '4376204',
    '6089455',
    '6180905',
    '4292515',
    '466421',
    '2526360',
    '952791',
    '2365634',
    '634423',
    '1130692',
    '3448782',
    '7091909',
    '1421917',
    '2391720',
    '4496052',
    '4920179',
    '6126370',
    '685006',
    '1312766',
    '4809346',
    '1254877-1E',
    '2201874',
    '2242111',
    '2641956',
    '1311415',
    '2717983',
    '6170952',
    '3497470',
    '5619344',
    '2250582',
    '2637348',
    '3537951',
    '831184',
    '2497851',
    '3273486',
    '4269201',
    '4387292',
    '3436372',
    '4428287',
    '1737562',
    '3397458',
    '398010',
    '1388060',
    '1938537',
    '3403348',
    '2860609',
    '4740175',
    '5598257',
    '6067778',
    '477974',
    '2556473',
    '1823264',
    '3693134',
    '3456661',
    '2173175',
    '2307299',
    '3093650',
    '2544126',
    '4977320',
    '485581',
    '2321462',
    '2353853',
    '6037455',
    '2456843',
    '3743266',
    '6782854',
    '2924958',
    '2924958',
    '2055747',
    '2424772',
    '6848915',
    '2529807',
    '3309221',
    '2214292',
    '2044247',
    '3621620',
    '4331340',
    '2126389',
    '1072211',
    '2671984',
    '3833025',
    '3275679',
    '498259',
    '1398376',
    '2475316',
    '2748738',
    '2764762',
    '6008408',
    '2234722',
    '2056372',
    '2294639',
    '4194984',
    '838398',
    '4194815',
    '4984318',
    '1081043',
    '2600714',
    '3457804',
    '3580071',
    '5396838',
    '830869',
    '4440265',
    '3119328',
    '4338670',
    '4904167',
    '4984414',
    '6344863',
    '1023214',
    '633460',
    '2037942',
    '2055497',
    '2241802',
    '2510625',
    '2058912',
    '2658833',
    '4640695',
    '3435749',
    '108750',
    '1389731',
    '4901435',
    '3394277',
    '1764285',
    '5655684',
    '471208',
    '5381488',
    '1007505',
    '6783194',
    '4197438',
    '2339529',
    '3374895',
    '2603979',
    '6781564',
    '3562080',
    '490524',
    '3572774',
    '4170744',
    '9922962',
    '379727',
    '3396473',
    '2865046'
]);
$observation = ObservationType::find(2);
$count = 0;
foreach ($collect as $c) {
    $a = Affiliate::where('identity_card', $c)->first();
    if ($a) { } else {
        $s = Spouse::where('identity_card', $c)->first();
        if ($s) {
            $a = $s->affiliate;
            // echo "found in spouse\n";
        } else {
            // echo "Affiliate no FOund in Spouse $c\n";
        }
    }
    if ($a) {
        if ($a->observations->contains(2)) {
            // echo "ya tiene \n";
        } else {
            $a->observations()->save($observation, [
                'user_id' => 1,
                'date' => \Carbon\Carbon::now(),
                'message' => 'ObservaciÃ³n importada',
                'enabled' => false
            ]);
            echo ".";
        }
    } else {
        echo "affiliate Not found $c\n";
    }
    $count++;
}
echo $count;
